--Q2 Popular time Slots
-- Identify the time slots during which the most orders are placed based on 2-hour interval
-- Solution
Select
	case
		WhEN EXTRACT (HOUR FROM ORDER_TIME) BETWEEN 0 AND 1 THEN '00:00 - 02:00'
		WhEN EXTRACT (HOUR FROM ORDER_TIME) BETWEEN 2 AND 3 THEN '02:00 - 04:00'
		WhEN EXTRACT (HOUR FROM ORDER_TIME) BETWEEN 4 AND 5 THEN '04:00 - 06:00'
		WhEN EXTRACT (HOUR FROM ORDER_TIME) BETWEEN 6 AND 7 THEN '06:00 - 08:00'
		WhEN EXTRACT (HOUR FROM ORDER_TIME) BETWEEN 8 AND 9 THEN '08:00 - 10:00'
		WhEN EXTRACT (HOUR FROM ORDER_TIME) BETWEEN 10 AND 11 THEN '10:00 - 12:00'
		WhEN EXTRACT (HOUR FROM ORDER_TIME) BETWEEN 12 AND 13 THEN '12:00 - 14:00'
		WhEN EXTRACT (HOUR FROM ORDER_TIME) BETWEEN 14 AND 15 THEN '14:00 - 16:00'
		WhEN EXTRACT (HOUR FROM ORDER_TIME) BETWEEN 16 AND 17 THEN '16:00 - 18:00'
		WhEN EXTRACT (HOUR FROM ORDER_TIME) BETWEEN 18 AND 19 THEN '18:00 - 20:00'
		WhEN EXTRACT (HOUR FROM ORDER_TIME) BETWEEN 20 AND 21 THEN '20:00 - 22:00'
		WhEN EXTRACT (HOUR FROM ORDER_TIME) BETWEEN 22 AND 23 THEN '22:00 - 00:00'
	END AS time_slot,
	Count(order_id) as order_count
FROM Orders
group by time_slot
order by order_count DESc;
-- limit cn be used for the maximum order count
		
		
